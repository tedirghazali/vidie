import{ref as e,reactive as a,computed as u}from"vue";import{date as l,array as t,number as v}from"alga-js";function n(v=null,n=null,r=null,s={value:"en-US"},o={value:"short"}){const m=e(0),D=e(0),g=e(0),b=e(0),N=e([]),y=a({dateEvent:"startdate"});m.value=null!==v&&0!==v.value?v.value:Number((new Date).getFullYear()),D.value=null!==n&&0!==n.value?n.value:Number((new Date).getMonth())+1,g.value=null!==r&&0!==r.value?r.value:Number((new Date).getDate());const h=u((()=>l.days(s.value,o.value))),d=u((()=>l.week(m.value,D.value,g.value)));b.value=d.value;const w=u((()=>l.weeks(m.value,b.value,"YYYY-MM-DD"))),f=u((()=>{const e=Number(new Date(m.value,Number(D.value)-1,1).getDay());let a=[];if(e>0){for(let u=Number(l.daysInMonth(m.value,Number(D.value)-1))-(e-1);u<=Number(l.daysInMonth(m.value,Number(D.value)-1));u++)a.push(u)}return a})),i=u((()=>l.daysInMonth(m.value,D.value))),Y=u((()=>{const e=Number(new Date(m.value,Number(D.value)-1,Number(l.daysInMonth(m.value,D.value))).getDay());let a=[];if(e<6){const u=6-e;for(let e=1;e<=u;e++)a.push(e)}return a})),c=Number(new Date(m.value,Number(D.value)-1,g.value).getDay()),M=u((()=>{let e=[];if(c>0){const a=c+1;for(let u=1;u<a;u++)e.push(l.subtractDate(new Date(m.value,Number(D.value)-1,g.value),u),"YYYY-MM-DD")}return e})),p=u((()=>{let e=[];if(c<6){const a=6-c;for(let u=1;u<=a;u++)e.push(l.addDate(new Date(m.value,Number(D.value)-1,g.value),u),"YYYY-MM-DD")}return e})),k=u((()=>N.value.length>=1?t.group(N.value,(e=>{if(y.dateEvent in e)return new Date(e[y.dateEvent]).getDate()})):[])),E=u((()=>N.value.length>=1?t.group(N.value,(e=>{if(y.dateEvent in e)return new Date(e[y.dateEvent]).getHours()})):[]));return{setYearRef:m,setMonthRef:D,setDayRef:g,setWeeks:b,getWeeks:d,getWeekDays:w,getDayNames:h,getPrevDays:f,getMonthDays:i,getNextDays:Y,getBeforeDays:M,getAfterDays:p,setEvents:N,getEvents:k,getEventsByTime:E}}function r(a=null,t=null,n=null,r={value:"en-US"},s={value:"short"},o={value:"long"}){const m=e(0),D=e(0),g=e(0),b=e(0),N=e(0),y=e(""),h=e(0);m.value=null!==a&&0!==a.value?a.value:Number((new Date).getFullYear()),D.value=null!==t&&0!==t.value?t.value:Number((new Date).getMonth())+1,g.value=null!==n&&0!==n.value?n.value:(new Date).getDate();const d=u((()=>{const e=0!==b.value?b.value:1980,a=0!==N.value?N.value:Number((new Date).getFullYear())+5;return v.loop(e,a)})),w=u((()=>l.months(r.value,o.value))),f=u((()=>l.days(r.value,s.value))),i=u((()=>l.week(m.value,D.value,g.value)));h.value=i.value;const Y=u((()=>{let e="";return e="daily"===y.value?`${f.value[new Date(m.value,Number(D.value)-1,g.value).getDay()]}, ${g.value} ${w.value[new Date(m.value,Number(D.value)-1).getMonth()]} ${m.value}`:"weekly"===y.value?`Week ${h.value}`:"yearly"===y.value?`${m.value}`:`${w.value[new Date(m.value,Number(D.value)-1).getMonth()]} ${m.value}`,e}));return{setYearRef:m,setMonthRef:D,setDayRef:g,setWeeks:h,setCalendarType:y,startYear:b,endYear:N,getRangeYears:d,getMonthNames:w,getDayNames:f,getWeeks:i,getCalendarTitle:Y,handleYear:e=>{m.value="prev"===e?m.value-1:"next"===e?m.value+1:(new Date).getFullYear()},handleMonth:e=>{"prev"===e?D.value>1&&D.value<=12?D.value=D.value-1:1===D.value&&(D.value=12,m.value=m.value-1):"next"===e?D.value>=1&&D.value<12?D.value=D.value+1:12===D.value&&(D.value=1,m.value=m.value+1):(D.value=Number((new Date).getMonth())+1,m.value=(new Date).getFullYear())},handleWeek:e=>{"prev"===e?1!==h.value?h.value=h.value-1:h.value=52:"next"===e?52!==h.value?h.value=h.value+1:h.value=1:h.value=i.value},handleDay:e=>{"prev"===e?1!==g.value?g.value=g.value-1:(g.value=Number(l.daysInMonth(m.value,Number(D.value)-1)),D.value>1&&D.value<=12?D.value=D.value-1:1===D.value&&(D.value=12,m.value=m.value-1)):"next"===e?g.value!==Number(l.daysInMonth(m.value,D.value))?g.value=g.value+1:(g.value=1,D.value>=1&&D.value<12?D.value=D.value+1:12===D.value&&(D.value=1,m.value=m.value+1)):(D.value=Number((new Date).getMonth())+1,m.value=(new Date).getFullYear(),g.value=(new Date).getDate())}}}function s(a="quantity",l="price",t="amount"){const v=e([]),n=e([]),r=u((()=>v.value.map((e=>(e[t]=Number((Number(e[a])*Number(e[l])).toFixed(2)),e))))),s=u((()=>v.value.length>=1?Number(v.value.map((e=>Number(e[a])*Number(e[l]))).reduce(((e,a)=>e+a)).toFixed(2)):0)),o=u((()=>n.value.map((e=>("percent"===e.type&&(e.amount=Number(e.amount)/100*Number(s.value),e.type="number"),e))))),m=u((()=>{let e=s.value;for(let a of o.value)e="subtraction"===a.calc?Number(e)-Number(a.amount):Number(e)+Number(a.amount);return Number(e.toFixed(2))}));return{setEntries:v,setRates:n,getEntries:r,getSubTotal:s,getRates:o,getTotal:m}}export{r as handleCalendar,s as useCalculate,n as useCalendar};
